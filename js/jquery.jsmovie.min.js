(function(h){var g={images:[],sequence:"",from:0,to:1,step:1,folder:"pic/",grid:{height:800,width:600,rows:1,columns:1},loader:{path:"img/loader2.png",height:50,width:50,rows:2,columns:4},fps:12,width:640,height:480,loadParallel:1,repeat:true,playOnLoad:false,playBackwards:false,showPreLoader:true,verbose:true};var f={init:function(j){if(j!=undefined){h.extend(g,j)}return this.each(function(){var o=h(this).data("jsMovie");if(!o){h(this).data("settings",g);h(this).data("jsMovie",h(this));if(h(this).data("settings").sequence!==""){h(this).data("settings").images=[];var q;for(var n=h(this).data("settings").from;n<=h(this).data("settings").to;n=n+h(this).data("settings").step){var k=1;if(n>0){k=(Math.floor(Math.log(n)/Math.log(10))+1)}q=new RegExp("^(.*?)([#]{1,"+k+"}?)([^#]+)","g");var r=q.exec(h(this).data("settings").sequence);h(this).data("settings").images.push((r[1]+n+r[3]).replace(/#/g,"0"))}}h(this).data("restoreCss",{width:h(this).width(),height:h(this).height(),overflow:h(this).css("overflow")});h(this).css({width:h(this).data("settings").width,height:h(this).data("settings").height,overflow:"hidden"});h(this).data("currentFrame",h(this));var m=0;for(var p=0;p<h(this).data("settings").images.length;p++){for(var t=0;t<h(this).data("settings").grid.rows;t++){for(var l=0;l<h(this).data("settings").grid.columns;l++){h(this).data("frame"+m,h("<div class='jsMovieFrame' />"));h(this).append(h(this).data("frame"+m));h(this).data("currentFrame",h(this).data("frame"+m));h(this).data("currentFrame").hide();h(this).data("frame"+m).css({width:h(this).data("settings").width,height:h(this).data("settings").height,"background-position":(-h(this).data("settings").grid.width*l)+"px "+(-h(this).data("settings").grid.height*t)+"px","background-repeat":"no-repeat"}).data("frame",m+1);m++}}}h(this).data("currentStatus","stopped");h(this).bind("play",e);h(this).bind("stop",c);h(this).bind("pause",b);h(this).data("frame0").show();h(this).data("currentFrame",h(this).data("frame0"));h(this).data("currentFrame").css({"background-image":'url("'+h(this).data("settings").folder+h(this).data("settings").images[0]+'")'});h(this).append("<div id='jsMovie_event_overlay'></div>");h(this).append("<div id='jsMovie_image_preload_container'></div>");var s=h(this);h("#jsMovie_event_overlay").css({width:h(s).data("settings").width,height:h(s).data("settings").height*2,"margin-top":"-"+(h(s).data("settings").height*2)+"px"});a.apply(h(this));d.apply(h(this))}else{f.throwError(1)}})},option:function(j,k){if(k==undefined){return this.data("settings")[j]}else{this.data("settings")[j]=k;return this}},realFps:function(){return h(this).data("realFps")},play:function(){h(this).data("currentStatus","play");h(this).trigger("play");return this},pause:function(){h(this).data("currentStatus","paused");h(this).trigger("pause");return this},stop:function(){h(this).data("currentStatus","stopped");h(this).trigger("stop");return this},playUntil:function(j){h(this).data("playUntil",j);if(j!=h(this).data("currentFrame").data("frame")){f.play.apply(this)}return this},gotoFrame:function(k){var j=this;h(this).find(".jsMovieFrame").each(function(l,m){if(k==h(this).data("frame")&&h(this).data("loaded")!==undefined){h(j).find(".jsMovieFrame").hide();h(j).data("currentFrame",h(this));h(j).data("currentFrame").show()}else{h(j).data("gotoFrameOnLoaded",k)}});return this},destroy:function(){return this.each(function(){h(this).children().remove();h(this).css(h(this).data("restoreCss"));clearInterval(h(this).data("playingInterval"));h(this).removeData()})},throwError:function(k){var j="";if(k!=undefined){if(k==1){j="This Objekt has already been initialized!"}else{if(true){j="Unknown Error"}}}else{j="Unknown Error"}if(window.console){console.log(j)}else{alert(j)}}};function e(k){if(h(this).data("currentStatus")=="play"){clearInterval(h(this).data("playingInterval"));h(this).data("currentStatus","playing");var j=this;h(this).data("playingInterval",setInterval(function(){if(h(j).data("realFpsTimeStamp")!=undefined){h(j).data("realFps",1/(((new Date()).getTime()-h(j).data("realFpsTimeStamp"))/1000))}else{h(j).data("realFps",h(j).data("settings").fps)}h(j).data("realFpsTimeStamp",(new Date()).getTime());if(h(j).data("settings").playBackwards){if(h(j).data("currentFrame").data("frame")!=1){h(j).data("currentFrame").prev().show();h(j).data("currentFrame").hide();h(j).data("currentFrame",h(j).data("currentFrame").prev());h(j).trigger("playing")}else{if(h(j).data("settings").repeat){h(j).data("currentFrame").siblings(".jsMovieFrame").last().show();h(j).data("currentFrame").hide();h(j).data("currentFrame",h(j).data("currentFrame").siblings(".jsMovieFrame").last());h(j).trigger("playing")}else{h(j).trigger("stop")}}}else{if(h(j).data("currentFrame").next(".jsMovieFrame").length==0){h(j).data("frame0").show();h(j).data("currentFrame").hide();h(j).data("currentFrame",h(j).data("frame0"));h(j).trigger("playing")}else{if(h(j).data("settings").repeat){h(j).data("currentFrame").next().show();h(j).data("currentFrame").hide();h(j).data("currentFrame",h(j).data("currentFrame").next());h(j).trigger("playing")}else{h(j).trigger("stop")}}}if(h(j).data("playUntil")==h(j).data("currentFrame").data("frame")){h(j).trigger("pause");h(j).data("playUntil",-1)}},1000/h(this).data("settings").fps))}}function c(j){clearInterval(h(this).data("playingInterval"));h(this).find(".jsMovieFrame").hide();h(this).data("currentFrame",h(this).data("frame0"));h(this).data("currentFrame").show();h(this).data("currentStatus","stop");h(this).data("playUntil",-1)}function b(j){clearInterval(h(this).data("playingInterval"))}function a(l){if(l==undefined){l=0;this.data("loadStatus","loading");for(loadParralelCount=1;loadParralelCount<=this.data("settings").loadParallel;loadParralelCount++){a.apply(this,[loadParralelCount])}return}if(l>this.data("settings").images.length){this.data("loadStatus","loaded");this.trigger("loaded");if(this.data("settings").playOnLoad){f.play.apply(j)}return}var k=new Image();var j=this;k.onload=function(){var o=h(j).data("settings").grid.rows*h(j).data("settings").grid.columns;for(var n=0;n<o;n++){h(j).data("frame"+(n+((l-1)*o))).css({"background-image":"url("+h(j).data("settings").folder+h(j).data("settings").images[l-1]+")"});h(j).data("frame"+(n+((l-1)*o))).data("loaded",true)}if(h(j).data("gotoFrameOnLoaded")!=undefined&&Math.ceil(h(j).data("gotoFrameOnLoaded")/o)==l){var m=h(j).data("gotoFrameOnLoaded");h(j).removeData("gotoFrameOnLoaded");f.gotoFrame.apply(h(j),[m])}a.apply(j,[l+j.data("settings").loadParallel]);i.apply(j,["Image #"+(l)+" has been loaded"])};k.src=h(this).data("settings").folder+h(this).data("settings").images[l-1];h("#jsMovie_image_preload_container").append(k);h(k).css({height:"1px",width:"1px"})}function d(){if(this.data("loadStatus")!="loaded"&&h(this).data("settings").showPreLoader){this.append("<div class='laoderOverlay' />").children(".laoderOverlay").css({"background-color":"black",opacity:0.8,height:this.height()+"px",width:this.width()+"px",position:"absolute",top:this.offset().top+"px",left:this.offset().left+"px"});this.append("<div class='laoderAnimation' />").children(".laoderAnimation").css({"background-image":"url("+h(this).data("settings").loader.path+")",height:h(this).data("settings").loader.height+"px",width:h(this).data("settings").loader.width+"px",position:"absolute",top:(this.offset().top+(this.height()/2)-(h(this).data("settings").loader.height/2))+"px",left:(this.offset().left+(this.width()/2)-(h(this).data("settings").loader.width/2))+"px","background-repeat":"no-repeat"});this.children(".laoderAnimation").data("currentFrame",0);var j=this;var k=setInterval(function(){if(j.data("loadStatus")=="loaded"){j.children(".laoderOverlay, .laoderAnimation").remove();clearInterval(k)}var l=j.children(".laoderAnimation").data("currentFrame");j.children(".laoderAnimation").css({"background-position":(-h(j).data("settings").loader.width*(l%h(j).data("settings").loader.columns))+"px "+(-h(j).data("settings").loader.height*Math.floor(l/h(j).data("settings").loader.columns))+"px"});j.children(".laoderAnimation").data("currentFrame",(l+1)%(h(j).data("settings").loader.rows*h(j).data("settings").loader.columns))},100)}}function i(j){this.trigger("verbose",j)}h.fn.jsMovie=function(j){if(f[j]){return f[j].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof j==="object"||!j){return f.init.apply(this,arguments)}else{h.error("Method "+j+" does not exist on jQuery.jsMovie")}}}})(jQuery);